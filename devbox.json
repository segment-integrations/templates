{
  "packages": {
    "process-compose": "latest",
    "act": "latest",
    "shellcheck": "latest"
  },
  "shell": {
    "scripts": {
      "lint": [
        "echo 'Running orchestrated linting and validation...'",
        "process-compose -f tests/process-compose-lint.yaml --tui=${TEST_TUI:-false}"
      ],
      "lint:android": [
        "shellcheck -S warning plugins/android/scripts/*.sh"
      ],
      "lint:ios": [
        "shellcheck -S warning plugins/ios/scripts/*.sh"
      ],
      "lint:rn": [
        "bash -c 'if ls plugins/react-native/scripts/*.sh 1>/dev/null 2>&1; then shellcheck -S warning plugins/react-native/scripts/*.sh; else echo \"No React Native shell scripts to lint\"; fi'"
      ],
      "test:android": [
        "devbox run lint:android",
        "devbox run test:plugin:android",
        "devbox run test:integration:android"
      ],
      "test:ios:lib": [
        "sh plugins/tests/ios/test-lib.sh"
      ],
      "test:ios": [
        "devbox run lint:ios",
        "devbox run test:plugin:ios",
        "devbox run test:integration:ios"
      ],
      "test:rn": [
        "devbox run lint:rn"
      ],
      "test:unit": [
        "echo 'Running orchestrated unit tests...'",
        "process-compose -f tests/process-compose-unit-tests.yaml --tui=${TEST_TUI:-false}"
      ],
      "test:e2e:android": [
        "bash tests/e2e/e2e-android.sh"
      ],
      "test:e2e:ios": [
        "bash tests/e2e/e2e-ios.sh"
      ],
      "test:e2e:rn": [
        "bash tests/e2e/e2e-react-native.sh"
      ],
      "test:e2e": [
        "echo 'Running orchestrated E2E tests (sequential)...'",
        "process-compose -f tests/process-compose-e2e.yaml --tui=${TEST_TUI:-false}"
      ],
      "test": [
        "echo 'Cleaning previous test results...'",
        "rm -rf test-results/",
        "mkdir -p test-results/",
        "echo '========================================'",
        "echo 'Running ALL tests (lint, unit, workflows, e2e)'",
        "echo '========================================'",
        "echo ''",
        "process-compose -f tests/process-compose-all-tests.yaml --tui=${TEST_TUI:-false}"
      ],
      "check:workflows": [
        "for f in .github/workflows/*.yml; do",
        "  act -W \"$f\" -l > /dev/null 2>&1 || { echo \"✗ $f\"; exit 1; }",
        "  echo \"✓ $(basename $f)\"",
        "done"
      ],
      "sync": [
        "echo 'Syncing example projects with latest plugins...'",
        "echo ''",
        "echo '1/3 Android...'",
        "(cd examples/android && rm -rf .devbox devbox.d devbox.lock && devbox install)",
        "echo '    Generating device lock file...'",
        "(cd examples/android && ANDROID_DEVICES_EVAL=1 devbox run android:devices:eval > /dev/null)",
        "echo '  ✓ Android synced'",
        "echo ''",
        "echo '2/3 iOS...'",
        "(cd examples/ios && rm -rf .devbox devbox.d devbox.lock && devbox install)",
        "echo '    Generating device lock file...'",
        "(cd examples/ios && IOS_DEVICES_EVAL=1 devbox run ios:devices:eval > /dev/null)",
        "echo '  ✓ iOS synced'",
        "echo ''",
        "echo '3/3 React Native...'",
        "(cd examples/react-native && rm -rf .devbox devbox.d devbox.lock && devbox install)",
        "echo '    Generating Android lock file...'",
        "(cd examples/react-native && ANDROID_DEVICES_EVAL=1 devbox run android:devices:eval > /dev/null)",
        "echo '    Generating iOS lock file...'",
        "(cd examples/react-native && IOS_DEVICES_EVAL=1 devbox run ios:devices:eval > /dev/null)",
        "echo '  ✓ React Native synced'",
        "echo ''",
        "echo '✓ All examples synced successfully!'",
        "echo ''",
        "echo 'Note: AVDs and simulators will be created automatically on first emulator/simulator start.'"
      ],
      "test:plugin:android:lib": [
        "bash plugins/tests/android/test-lib.sh"
      ],
      "test:plugin:android:devices": [
        "bash plugins/tests/android/test-devices.sh"
      ],
      "test:plugin:android": [
        "devbox run test:plugin:android:lib",
        "devbox run test:plugin:android:devices"
      ],
      "test:plugin:ios:lib": [
        "sh plugins/tests/ios/test-lib.sh"
      ],
      "test:plugin:ios": [
        "devbox run test:plugin:ios:lib"
      ],
      "test:plugin:unit": [
        "echo 'Running plugin unit tests...'",
        "devbox run test:plugin:android",
        "devbox run test:plugin:ios"
      ],
      "test:integration:android:device-mgmt": [
        "bash tests/integration/android/test-device-mgmt.sh"
      ],
      "test:integration:android:validation": [
        "bash tests/integration/android/test-validation.sh"
      ],
      "test:integration:android": [
        "devbox run test:integration:android:device-mgmt",
        "devbox run test:integration:android:validation"
      ],
      "test:integration:ios:device-mgmt": [
        "bash tests/integration/ios/test-device-mgmt.sh"
      ],
      "test:integration:ios:cache": [
        "bash tests/integration/ios/test-cache.sh"
      ],
      "test:integration:ios": [
        "devbox run test:integration:ios:device-mgmt",
        "devbox run test:integration:ios:cache"
      ],
      "test:integration": [
        "echo 'Running integration tests...'",
        "devbox run test:integration:android",
        "devbox run test:integration:ios"
      ],
      "test:fast": [
        "echo 'Running fast tests (lint + unit + integration)...' ",
        "devbox run lint",
        "devbox run test:plugin:unit",
        "devbox run test:integration"
      ]
    }
  }
}
